function r(r, n) {
    return n >>> r | n << 32 - r;
}

function n(r, n, t) {
    return r & n ^ ~r & t;
}

function t(r, n, t) {
    return r & n ^ r & t ^ n & t;
}

function o(n) {
    return r(2, n) ^ r(13, n) ^ r(22, n);
}

function e(n, t) {
    return n[15 & t] += (r(17, o = n[t + 14 & 15]) ^ r(19, o) ^ o >>> 10) + n[t + 9 & 15] + function(n) {
        return r(7, n) ^ r(18, n) ^ n >>> 3;
    }(n[t + 1 & 15]);
    var o;
}

var f, a, u, c = new Array(1116352408, 1899447441, 3049323471, 3921009573, 961987163, 1508970993, 2453635748, 2870763221, 3624381080, 310598401, 607225278, 1426881987, 1925078388, 2162078206, 2614888103, 3248222580, 3835390401, 4022224774, 264347078, 604807628, 770255983, 1249150122, 1555081692, 1996064986, 2554220882, 2821834349, 2952996808, 3210313671, 3336571891, 3584528711, 113926993, 338241895, 666307205, 773529912, 1294757372, 1396182291, 1695183700, 1986661051, 2177026350, 2456956037, 2730485921, 2820302411, 3259730800, 3345764771, 3516065817, 3600352804, 4094571909, 275423344, 430227734, 506948616, 659060556, 883997877, 958139571, 1322822218, 1537002063, 1747873779, 1955562222, 2024104815, 2227730452, 2361852424, 2428436474, 2756734187, 3204031479, 3329325298);

function i(r, n) {
    var t = (65535 & r) + (65535 & n);
    return (r >> 16) + (n >> 16) + (t >> 16) << 16 | 65535 & t;
}

function v() {
    var a, v, A, s, w, d, h, y, g, l, C, b = new Array(16);
    a = f[0], v = f[1], A = f[2], s = f[3], w = f[4], d = f[5], h = f[6], y = f[7];
    for (var m = 0; m < 16; m++) b[m] = u[3 + (m << 2)] | u[2 + (m << 2)] << 8 | u[1 + (m << 2)] << 16 | u[m << 2] << 24;
    for (var p = 0; p < 64; p++) g = y + (r(6, C = w) ^ r(11, C) ^ r(25, C)) + n(w, d, h) + c[p], 
    g += p < 16 ? b[p] : e(b, p), l = o(a) + t(a, v, A), y = h, h = d, d = w, w = i(s, g), 
    s = A, A = v, v = a, a = i(g, l);
    f[0] += a, f[1] += v, f[2] += A, f[3] += s, f[4] += w, f[5] += d, f[6] += h, f[7] += y;
}

function A(r) {
    return f = new Array(8), a = new Array(2), u = new Array(64), a[0] = a[1] = 0, f[0] = 1779033703, 
    f[1] = 3144134277, f[2] = 1013904242, f[3] = 2773480762, f[4] = 1359893119, f[5] = 2600822924, 
    f[6] = 528734635, f[7] = 1541459225, function(r, n) {
        var t, o, e = 0;
        o = a[0] >> 3 & 63;
        var f = 63 & n;
        for ((a[0] += n << 3) < n << 3 && a[1]++, a[1] += n >> 29, t = 0; t + 63 < n; t += 64) {
            for (var c = o; c < 64; c++) u[c] = r.charCodeAt(e++);
            v(), o = 0;
        }
        for (c = 0; c < f; c++) u[c] = r.charCodeAt(e++);
    }(r, r.length), function() {
        var r = a[0] >> 3 & 63;
        if (u[r++] = 128, r <= 56) for (var n = r; n < 56; n++) u[n] = 0; else {
            for (n = r; n < 64; n++) u[n] = 0;
            v();
            for (n = 0; n < 56; n++) u[n] = 0;
        }
        u[56] = a[1] >>> 24 & 255, u[57] = a[1] >>> 16 & 255, u[58] = a[1] >>> 8 & 255, 
        u[59] = 255 & a[1], u[60] = a[0] >>> 24 & 255, u[61] = a[0] >>> 16 & 255, u[62] = a[0] >>> 8 & 255, 
        u[63] = 255 & a[0], v();
    }(), function() {
        for (var r = new String(), n = 0; n < 8; n++) for (var t = 28; t >= 0; t -= 4) r += "0123456789abcdef".charAt(f[n] >>> t & 15);
        return r;
    }();
}

module.exports = {
    sha256_digest: A
};