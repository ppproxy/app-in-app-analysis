function t(t, e, n) {
    return e in t ? Object.defineProperty(t, e, {
        value: n,
        enumerable: !0,
        configurable: !0,
        writable: !0
    }) : t[e] = n, t;
}

function e(t, e) {
    if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
}

var n = function() {
    function t(t, e) {
        var n = [], r = !0, o = !1, i = void 0;
        try {
            for (var a, c = t[Symbol.iterator](); !(r = (a = c.next()).done) && (n.push(a.value), 
            !e || n.length !== e); r = !0) ;
        } catch (t) {
            o = !0, i = t;
        } finally {
            try {
                !r && c.return && c.return();
            } finally {
                if (o) throw i;
            }
        }
        return n;
    }
    return function(e, n) {
        if (Array.isArray(e)) return e;
        if (Symbol.iterator in Object(e)) return t(e, n);
        throw new TypeError("Invalid attempt to destructure non-iterable instance");
    };
}(), r = function() {
    function t(t, e) {
        for (var n = 0; n < e.length; n++) {
            var r = e[n];
            r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), 
            Object.defineProperty(t, r.key, r);
        }
    }
    return function(e, n, r) {
        return n && t(e.prototype, n), r && t(e, r), e;
    };
}(), o = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(t) {
    return typeof t;
} : function(t) {
    return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
};

!function(t, e) {
    "object" == ("undefined" == typeof exports ? "undefined" : o(exports)) && "undefined" != typeof module ? module.exports = e() : "function" == typeof define && define.amd ? define(e) : (t = t || self).anim = e();
}(void 0, function() {
    function i(t) {
        return e = t.reduce(function(t, e) {
            return Object.keys(e).forEach(function(n) {
                if (p.includes(n)) return t[n].push(e[n]);
                h.includes(n) ? t[n] = Object.assign({}, t[n], e[n]) : t[n] = e[n];
            }), t;
        }, function() {
            var t = p.reduce(function(t, e) {
                return t[e] = [], t;
            }, {});
            return Object.assign({
                mixins: [],
                data: {}
            }, t);
        }()), p.reduce(function(t, e) {
            return t[e] && t[e].length > 0 ? (t["__anim_" + e] = t[e].slice(), t[e] = function() {
                for (var n = this, r = arguments.length, o = Array(r), i = 0; i < r; i++) o[i] = arguments[i];
                t["__anim_" + e].forEach(function(t) {
                    t.apply(n, o);
                });
            }) : delete t[e], t;
        }, e);
        var e;
    }
    function a(t, e, n, r) {
        function o() {
            a && clearTimeout(a);
        }
        function i() {
            function i() {
                u = Date.now(), n.apply(f, l);
            }
            var f = this, s = Date.now() - u, l = arguments;
            c || (r && !a && i(), o(), void 0 === r && s > t ? i() : !0 !== e && (a = setTimeout(r ? function() {
                a = void 0;
            } : i, void 0 === r ? t - s : t)));
        }
        var a, c = !1, u = 0;
        return "boolean" != typeof e && (r = n, n = e, e = void 0), i.cancel = function() {
            o(), c = !0;
        }, i;
    }
    function c(t, e, n) {
        return void 0 === n ? a(t, e, !1) : a(t, n, !1 !== e);
    }
    function u(t) {
        return String.prototype.split.call(t, /[,[\].]+?/).filter(Boolean);
    }
    function f(t) {
        if (t.watch) {
            var e = {};
            Object.keys(t.watch).forEach(function(n) {
                var r = t.watch[n];
                if ("function" == typeof r) {
                    var o = u(n).slice(0, -1), i = u(n).slice(-1)[0] || n;
                    e[n] = function(t, e) {
                        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null;
                        return u(e).reduce(function(t, e) {
                            return Object.hasOwnProperty.call(t, e) ? t[e] : n;
                        }, t);
                    }(t.data, n);
                    var a = t.data;
                    o.forEach(function(t) {
                        a = a[t];
                    });
                    var f = Object.getOwnPropertyDescriptor(a, i);
                    f && Object.defineProperty(a, i, {
                        configurable: f.configurable,
                        enumerable: f.enumerable,
                        get: function() {
                            return f && f.get ? f.get() : e[n];
                        },
                        set: c(10, function(o) {
                            var i = e[n];
                            r.call(t, o, i), f && f.set && f.set(o), e[n] = o;
                        })
                    });
                }
            });
        }
    }
    function s() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, e = getCurrentPages().slice(-1)[0], n = void 0;
        n = t.__anim__query ? JSON.parse(decodeURIComponent(t.__anim__query)) : {};
        var r, o = {
            path: e.route,
            query: n
        };
        this.$route = o, this.setData && this.setData({
            $route: o
        }), (r = this).$router = {
            navigateTo: function(t) {
                return t.__anim_route_type = "navigateTo", O.length < 10 ? j.navigateTo({
                    url: l(t)
                }) : r.$router.redirectTo(t);
            },
            navigateBack: function() {
                var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1;
                return j.navigateBack({
                    delta: t
                });
            },
            redirectTo: function(t) {
                return t.__anim_route_type = "redirectTo", j.redirectTo({
                    url: l(t)
                });
            },
            reLaunch: function(t) {
                return t.__anim_route_type = "reLaunch", j.reLaunch({
                    url: l(t)
                });
            },
            switchTab: function(t) {
                return t.__anim_route_type = "switchTab", j.switchTab({
                    url: l(t)
                });
            },
            go: function(t) {
                if (t < 0) return j.navigateBack({
                    delta: Math.abs(t)
                });
            }
        }, "reLaunch" === n.__anim_route_type ? O = [ o ] : O.push(o), this.$routes = O;
    }
    function l(t) {
        var e = encodeURIComponent(JSON.stringify(Object.assign({}, t.query, {
            __anim_route_type: t.__anim_route_type
        })));
        return t.path + "?__anim__query=" + e;
    }
    function d(t) {
        var e = C.slice();
        Array.isArray(t.mixins) && (e = e.concat(t.mixins));
        var n = i(e.concat(t));
        if (n.store && "function" == typeof n.store) {
            var r = U(n.store);
            return Page(r(n));
        }
        return Page(n);
    }
    var p = [ "onLoad", "onShow", "onReady", "onHide", "onUnload", "onPullDownRefresh", "onReachBottom", "onPageScroll", "onResize" ], h = [ "data", "computed", "watch" ], y = 0, b = function() {
        function t() {
            e(this, t), this.subs = [], this.id = ++y;
        }
        return r(t, [ {
            key: "addSub",
            value: function(t) {
                this.subs.push(t);
            }
        }, {
            key: "depend",
            value: function() {
                t.target && t.target.addDep(this);
            }
        }, {
            key: "notify",
            value: function() {
                this.subs.forEach(function(t) {
                    setTimeout(function() {
                        return t.update();
                    });
                });
            }
        } ]), t;
    }(), v = 0, g = function() {
        function t(n, r, o) {
            e(this, t), this.id = ++v, this.depIdMap = {}, this.dep = new b(), this.vm = n, 
            this.fn = r, this.cb = o, this.value = this.getValue(), this.oldValue = void 0;
        }
        return r(t, [ {
            key: "getValue",
            value: function() {
                b.target = this;
                var t = this.fn.call(this.vm);
                return b.target = void 0, t;
            }
        }, {
            key: "update",
            value: function() {
                this.oldValue = this.value, this.value = this.getValue(), this.cb.call(this.vm);
            }
        }, {
            key: "addDep",
            value: function(t) {
                this.depIdMap.hasOwnProperty(t.id) || (t.addSub(this), this.depIdMap[t.id] = t);
            }
        }, {
            key: "depend",
            value: function() {
                this.dep.depend();
            }
        } ]), t;
    }(), _ = {
        onLoad: function() {
            var e;
            "object" == o((e = this).data) && "null" !== e.data && Object.keys(e.data).forEach(function(t) {
                var n = Object.assign({}, e.data)[t], r = new b();
                Object.defineProperty(e.data, t, {
                    set: function(t) {
                        t === n || t != t && n != n || (n = t, r.notify());
                    },
                    get: function() {
                        return r.depend(), n;
                    }
                });
            }), function(t) {
                wx.nextTick ? wx.nextTick(function() {
                    return f(t);
                }) : setTimeout(function() {
                    return f(t);
                });
            }(this), function(e) {
                if (e.computed) {
                    var n = {};
                    Object.keys(e.computed).forEach(function(r) {
                        var o = e.computed[r];
                        if ("function" == typeof o) {
                            var i = new g(e, o, function() {
                                e.setData && e.setData(t({}, r, i.value));
                            });
                            e.data[r] = i.value, n[r] = i.value, Object.defineProperty(e.data, r, {
                                configurable: !0,
                                enumerable: !0,
                                set: function(t) {
                                    return t;
                                },
                                get: function() {
                                    return i.depend(), i.value;
                                }
                            });
                        }
                    }), e.setData && e.setData(n);
                }
            }(this);
        }
    }, m = Object.keys(wx).filter(function(t) {
        return t.endsWith("Sync");
    }).map(function(t) {
        return t.replace(/Sync$/, "");
    }).concat([ "navigateTo", "navigateBack", "redirectTo", "reLaunch" ]).concat([ "request", "downloadFile", "uploadFile" ]).reduce(function(t, e) {
        return t[e] = function(t) {
            return function(e) {
                return new Promise(function(n, r) {
                    t(Object.assign({}, e, {
                        success: function(t) {
                            e.success && e.success(t), n(t);
                        },
                        fail: function(t) {
                            e.fail && e.fail(t), r(t);
                        }
                    }));
                });
            };
        }(wx[e]), t;
    }, {}), j = Object.assign({}, wx, m), O = [], w = {
        onLoad: function(t) {
            s.call(this, t);
        },
        onUnload: function() {
            (function() {
                O.pop();
            }).call(this);
        }
    }, k = {}, S = [], x = function t(e, n) {
        if (Object.prototype.toString.call(e) !== Object.prototype.toString.call(n)) return !1;
        if (Object.keys(e).length !== Object.keys(n).length) return !1;
        var r = !0;
        return Object.keys(e).forEach(function(o) {
            switch (Object.prototype.toString.call(e[o])) {
              case "[object Object]":
                t(e[o], n[o]) || (r = !1);
                break;

              case "[object Array]":
                T(e[o], n[o]) || (r = !1);
                break;

              default:
                e[o] !== n[o] && (r = !1);
            }
        }), r;
    }, T = function(t, e) {
        if (Object.prototype.toString.call(t) !== Object.prototype.toString.call(e)) return !1;
        if (t.length !== e.length) return !1;
        var n = !0;
        return t.forEach(function(t, r) {
            t !== e[r] && (n = !1);
        }), n;
    }, P = function t(e, n) {
        var r = {};
        return Object.keys(e).forEach(function(o) {
            if (!n || n.includes(o)) switch (Object.prototype.toString.call(e[o])) {
              case "[object Object]":
                r[o] = t(e[o]);
                break;

              case "[object Array]":
                r[o] = D(e[o]);
                break;

              default:
                r[o] = e[o];
            }
        }), r;
    }, D = function t(e) {
        return e.map(function(e) {
            switch (Object.prototype.toString.call(e)) {
              case "[object Object]":
                return P(e);

              case "[object Array]":
                return t(e);

              default:
                return e;
            }
        });
    }, E = function(t) {
        var e = Object.prototype.toString.call(t);
        return "[object Object]" === e || "[object Array]" === e;
    }, A = 0, L = (wx.getSystemInfoSync().system, void 0);
    try {
        L = Proxy;
    } catch (p) {
        L = function(t, e) {
            var n = Object.create(t.constructor.prototype, {
                __proxyhandler__: {
                    value: e
                }
            });
            return Object.keys(t).forEach(function(e) {
                Object.defineProperty(n, e, {
                    enumerable: !0,
                    get: function() {
                        return this.__proxyhandler__.get(t, e);
                    },
                    set: function(n) {
                        return this.__proxyhandler__.set(t, e, n);
                    }
                });
            }), n;
        };
    }
    var R = L, I = function t(e, r) {
        return Object.keys(e).forEach(function(n) {
            E(e[n]) && (e[n] = t(e[n], r.concat([ n ])));
        }), new R(e, {
            get: function(t, e) {
                if ("__isProxy" === e) return !0;
                if ("__data" === e) return q(r);
                var n = q(r.concat([ e ]));
                return void 0 !== n ? n : Reflect.get(t, e);
            },
            set: function(e, o, i) {
                var a = i.__isProxy && i.__data || i, c = E(a) && t(P(a), r.concat([ o ])) || a, u = Reflect.set(e, o, c);
                return B(r.concat([ o ]), a), A++, setTimeout(function() {
                    if (0 == --A) for (var t = S.length - 1; t >= 0; t--) {
                        var e = n(S[t], 3), r = e[0], o = e[1], i = e[2], a = o(k);
                        x(i, a) || (S[t][2] = P(a), r.setData(a));
                    }
                }, 5), u;
            }
        });
    }, q = function(t) {
        return t.reduce(function(t, e) {
            return t && t[e] || void 0;
        }, k);
    }, B = function(t, e) {
        var n = t.length, r = t[n - 1], o = k;
        t.forEach(function(t, e) {
            e !== n - 1 && (o = o[t]);
        }), o[r] = e;
    }, U = function(t) {
        return function(e) {
            var n = e.onLoad, r = e.onUnload;
            return e.onLoad = function() {
                var e = t(k);
                S.push([ this, t, P(e) ]), this.setData(e), n && n.apply(this, arguments);
            }, e.onUnload = function() {
                S.pop(), r && r.call(this);
            }, e;
        };
    }, $ = Object.freeze({
        mapToData: U,
        observe: function(t, e) {
            e = e || t.constructor.name.toLowerCase();
            var n = Object.getOwnPropertyNames(t);
            return t.__storeName__ = e, k[e] || (k[e] = P(t, n)), I(t, [ e ]);
        }
    }), C = [ _, w ];
    return d.mixin = function(t) {
        C = C.concat(t);
    }, {
        App: function(t) {
            function e(e) {
                return t.apply(this, arguments);
            }
            return e.toString = function() {
                return t.toString();
            }, e;
        }(function(t) {
            return App(t);
        }),
        Page: d,
        wedux: $,
        wechat: j
    };
});